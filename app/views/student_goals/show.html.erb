<h1><%= @student_goal.goal.name %> Goal for <%= @student_goal.student.first_name %></h1>
<h3><%= @student_goal.goal.category %></h3>
<p>
  SWBAT: <%= @student_goal.goal.objectives.sub(/[[:punct:]]+\z/, "") %>
  at <%= @student_goal.mastery_percent %>% accuracy by <%= @student_goal.target_date.strftime("%m/%d/%Y") %>.
</p>
<p>Start Date: <%= @student_goal.start_on.strftime("%m/%d/%Y") %></p>
<p>Target Date: <%= @student_goal.target_date.strftime("%m/%d/%Y") %></p>
<p>Baseline: <%= @student_goal.baseline %></p>
<p>Status: <%= @student_goal.status.sub("_", " ").titleize %></p>
<br>
<h3>Goal Progress</h3>

<%= form_with model: [@student, @student_goal, @progress_entry], data: { turbo: false } do |f| %>
  <%= render "shared/errors", resource: @progress_entry %>

  <div>
    <%= f.label :note, "Note *" %>
    <%= f.text_area :note %>
  </div>

  <div>
    <%= f.label :recorded_on, "Recorded On*" %>
    <%= f.date_field :recorded_on %>
  </div>

  <div>
    <%= f.label :evidence_url, "Evidence" %>
    <%= f.text_field :evidence_url %>
  </div>

  <div>
    <%= f.label :score_numeric, "Score" %>
    <%= f.number_field :score_numeric %>
  </div>

  <%= f.submit "Add Entry"%>

<% end %>

<ul>
  <% @progress_entries.each do |entry| %>
    <li>
      <h5>Entry <%= entry.recorded_on.strftime("%m/%d/%Y") %></h5>

      <p><%= entry.note %></p>

      <% if entry.evidence_url %>
        <p>Evidence: <%= entry.evidence_url %></p>
      <% end %>

      <% if entry.score_numeric %>
        <p>Score: <%= entry.score_numeric %></p>
      <% end %>

      <% if policy(entry).destroy? %>
        <%= button_to "❌", student_student_goal_progress_entry_path(@student, @student_goal, entry),
        method: :delete, data: { confirm: "Are you sure?" } %>
      <% end %>
    </li>
  <% end %>
</ul>
<br>
<%= link_to "Back to #{@student_goal.student.first_name}", @student_goal.student %>
